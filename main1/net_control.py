import subprocess
import re
import sys
import os

def get_network_adapters():
    """
    –û—Ç—Ä–∏–º—É—î —Å–ø–∏—Å–æ–∫ —É—Å—ñ—Ö –º–µ—Ä–µ–∂–µ–≤–∏—Ö –∞–¥–∞–ø—Ç–µ—Ä—ñ–≤ Windows —Ç–∞ —ó—Ö–Ω—ñ–π —Å—Ç–∞–Ω.
    –ü–æ–≤–µ—Ä—Ç–∞—î —Å–ª–æ–≤–Ω–∏–∫ {–Ω–æ–º–µ—Ä: –Ω–∞–∑–≤–∞_–∞–¥–∞–ø—Ç–µ—Ä–∞}.
    """
    print("‚è≥ –û—Ç—Ä–∏–º–∞–Ω–Ω—è —Å–ø–∏—Å–∫—É –º–µ—Ä–µ–∂–µ–≤–∏—Ö –∞–¥–∞–ø—Ç–µ—Ä—ñ–≤...")
    
    # –í–∏–∫–æ–Ω—É—î–º–æ –∫–æ–º–∞–Ω–¥—É –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –≤—Å—ñ –º–µ—Ä–µ–∂–µ–≤—ñ –∞–¥–∞–ø—Ç–µ—Ä–∏
    try:
        # 'netsh interface show interface' –ø—Ä–∞—Ü—é—î –Ω–∞ Windows –¥–ª—è –≤–∏–≤–æ–¥—É –∞–¥–∞–ø—Ç–µ—Ä—ñ–≤
        result = subprocess.run(['netsh', 'interface', 'show', 'interface'], 
                                capture_output=True, text=True, check=True, encoding='utf-8')
    except subprocess.CalledProcessError as e:
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥–∏ netsh: {e}")
        return {}
    except FileNotFoundError:
        print("‚ùå –ö–æ–º–∞–Ω–¥–∞ 'netsh' –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –í–∏ –ø—Ä–∞—Ü—é—î—Ç–µ –Ω–∞ Windows.")
        return {}

    adapters = {}
    lines = result.stdout.splitlines()
    
    # –†–µ–≥—É–ª—è—Ä–Ω–∏–π –≤–∏—Ä–∞–∑ –¥–ª—è –ø–æ—à—É–∫—É –Ω–∞–∑–≤–∏ –∞–¥–∞–ø—Ç–µ—Ä–∞
    # –ù–∞–∑–≤–∏ –∞–¥–∞–ø—Ç–µ—Ä—ñ–≤ –∑–∞–∑–≤–∏—á–∞–π –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è —É —Å—Ç–æ–≤–ø—Ü—ñ "–ù–∞–∑–≤–∞"
    
    for i, line in enumerate(lines):
        # –ü—Ä–æ–ø—É—Å–∫–∞—î–º–æ –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞ –ø–æ—Ä–æ–∂–Ω—ñ —Ä—è–¥–∫–∏
        if i < 3 or not line.strip():
            continue
        
        # –†—è–¥–æ–∫ –≤–∏–≤–æ–¥—É –≤–∏–≥–ª—è–¥–∞—î –ø—Ä–∏–±–ª–∏–∑–Ω–æ —Ç–∞–∫: 
        # "–ê–¥–º—ñ–Ω. –°—Ç–∞–Ω    –°—Ç–∞–Ω           –¢–∏–ø              –ù–∞–∑–≤–∞"
        # "---------------  -------------  ---------------  ---------------------"
        # "–£–≤—ñ–º–∫–Ω–µ–Ω–æ        –ü—ñ–¥–∫–ª—é—á–µ–Ω–æ     –í–∏–¥—ñ–ª–µ–Ω–∏–π        Wi-Fi"
        
        # –°–ø—Ä–æ–±–∞ –≤–∏–¥—ñ–ª–∏—Ç–∏ –Ω–∞–∑–≤—É –∞–¥–∞–ø—Ç–µ—Ä–∞ (—Ü–µ –∑–∞–∑–≤–∏—á–∞–π –æ—Å—Ç–∞–Ω–Ω—î –ø–æ–ª–µ)
        parts = line.split()
        if len(parts) >= 4:
            # –ù–∞–∑–≤–∞ –∞–¥–∞–ø—Ç–µ—Ä–∞ –º–æ–∂–µ –º—ñ—Å—Ç–∏—Ç–∏ –ø—Ä–æ–±—ñ–ª–∏, —Ç–æ–º—É –±–µ—Ä–µ–º–æ –≤—Å–µ, –ø–æ—á–∏–Ω–∞—é—á–∏ –∑ 4-–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞
            adapter_name = " ".join(parts[3:]) 
            adapters[len(adapters) + 1] = adapter_name
            
    return adapters

def disable_adapter(adapter_name):
    """–í—ñ–¥–∫–ª—é—á–∞—î –≤–∏–±—Ä–∞–Ω–∏–π –º–µ—Ä–µ–∂–µ–≤–∏–π –∞–¥–∞–ø—Ç–µ—Ä (–ø–æ—Ç—Ä—ñ–±–Ω—ñ –ø—Ä–∞–≤–∞ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞)."""
    print(f"\n‚öôÔ∏è –°–ø—Ä–æ–±–∞ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∞–¥–∞–ø—Ç–µ—Ä–∞: '{adapter_name}'...")
    
    try:
        # –í–∏–∫–æ–Ω—É—î–º–æ –∫–æ–º–∞–Ω–¥—É –¥–ª—è –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: 'netsh interface set interface [–Ω–∞–∑–≤–∞] disabled'
        result = subprocess.run(['netsh', 'interface', 'set', 'interface', adapter_name, 'disabled'], 
                                capture_output=True, text=True, check=False, encoding='utf-8')
        
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —É—Å–ø—ñ—Ö—É –∞–±–æ –ø–æ–º–∏–ª–∫–∏
        if result.returncode == 0:
            print(f"‚úÖ –ê–¥–∞–ø—Ç–µ—Ä '{adapter_name}' —É—Å–ø—ñ—à–Ω–æ –≤—ñ–¥–∫–ª—é—á–µ–Ω–æ.")
        else:
            # –Ø–∫—â–æ –Ω–µ–º–∞—î –ø—Ä–∞–≤ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∞–±–æ –∞–¥–∞–ø—Ç–µ—Ä –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ
            error_msg = result.stderr.strip() or result.stdout.strip()
            if "–∑–∞–∑–Ω–∞—á–µ–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å" in error_msg or "–ø—Ä–∞–≤–∞ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞" in error_msg:
                print(f"‚ùå –ü–û–ú–ò–õ–ö–ê: –ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–∫–ª—é—á–∏—Ç–∏ –∞–¥–∞–ø—Ç–µ—Ä. –°–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–∫—Ä–∏–ø—Ç –∑ –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞.")
            else:
                print(f"‚ùå –ü–û–ú–ò–õ–ö–ê: {error_msg}")
                
    except Exception as e:
        print(f"‚ùå –ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞: {e}")


if __name__ == "__main__":
    if sys.platform != 'win32':
        print("üõë –¶–µ–π —Å–∫—Ä–∏–ø—Ç –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –ª–∏—à–µ –¥–ª—è Windows.")
        sys.exit(1)
        
    adapters = get_network_adapters()

    if not adapters:
        print("‚ùå –ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ –∞–∫—Ç–∏–≤–Ω–∏—Ö –º–µ—Ä–µ–∂–µ–≤–∏—Ö –∞–¥–∞–ø—Ç–µ—Ä—ñ–≤ –∞–±–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è —ó—Ö –æ—Ç—Ä–∏–º–∞—Ç–∏.")
        sys.exit(1)

    print("\n--- –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –º–µ—Ä–µ–∂–µ–≤–∏—Ö –∞–¥–∞–ø—Ç–µ—Ä—ñ–≤ ---")
    for num, name in adapters.items():
        print(f"  [{num}] {name}")
    print("---------------------------------------------")

    try:
        choice = input("–í–≤–µ–¥—ñ—Ç—å –Ω–æ–º–µ—Ä –∞–¥–∞–ø—Ç–µ—Ä–∞, —è–∫–∏–π –±–∞–∂–∞—î—Ç–µ –≤—ñ–¥–∫–ª—é—á–∏—Ç–∏ (–∞–±–æ 'q' –¥–ª—è –≤–∏—Ö–æ–¥—É): ")
        if choice.lower() == 'q':
            print("–í–∏—Ö—ñ–¥.")
            sys.exit(0)
            
        choice_num = int(choice)
        
        if choice_num in adapters:
            selected_adapter = adapters[choice_num]
            disable_adapter(selected_adapter)
        else:
            print("‚ùå –ù–µ–≤—ñ—Ä–Ω–∏–π –Ω–æ–º–µ—Ä. –°–∫—Ä–∏–ø—Ç –∑–∞–≤–µ—Ä—à—É—î —Ä–æ–±–æ—Ç—É.")
            
    except ValueError:
        print("‚ùå –ù–µ–≤—ñ—Ä–Ω–∏–π –≤–≤—ñ–¥. –ü–æ—Ç—Ä—ñ–±–Ω–æ –≤–≤–µ—Å—Ç–∏ —á–∏—Å–ª–æ.")
    except Exception as e:
        print(f"–°—Ç–∞–ª–∞—Å—è –Ω–µ—Å–ø–æ–¥—ñ–≤–∞–Ω–∞ –ø–æ–º–∏–ª–∫–∞: {e}")